'use strict';mix_d("CustomerReviewsMediaCards__cr-media-carousel:cr-media-carousel__LEDe-HQs","exports tslib @c/browser-operations @c/aui-feature-detect @c/scoped-dom @c/metrics @c/navigation @c/dom @c/remote-operations @c/logger @p/A".split(" "),function(Ja,f,Za,$a,ab,bb,cb,ia,oa,db,eb){function aa(a){return a&&"object"===typeof a&&"default"in a?a:{"default":a}}function Ka(a,b,c){return"https://"+da()+"/portal/customer-reviews/media-gallery/ref="+a+"?ie=UTF8&asin="+c+"&mediaType="+b}function da(){var a=
R["default"].getLocation&&R["default"].getLocation().hostname||location.href,b=R["default"].getLocation&&R["default"].getLocation().host||location.host;return"localhost"===a?"pre-prod.amazon.com":b}function ta(a){return a?a===A.IMAGE?U.IMAGE:U.VIDEO:U.ALL}function fb(a){return Object.keys(a).map(function(b){return b+"="+a[b]}).join("&")}function gb(a,b){return f.__awaiter(this,void 0,void 0,function(){var c,d,e;return f.__generator(this,function(g){c=b.mediaType;d=b.metricsPrefix;K.logCounter(d+"IvxClicked",
1);e=Date.now();a.navigate({url:hb(b),successCallback:function(){var l=Date.now()-e;K.logCounter(d+"IvxNavigatedDuration",l);K.logCounter(d+"IvxNavigated",1);K.logNoError("loadIVXError",c)},failCallback:function(l){K.logCounter(d+"IvxNavigated",0);La("Failed to load SSNAP immersive modal for media: "+JSON.stringify(b)+".",l);K.logError("loadIVXError",c)}});return[2]})})}function hb(a){var b=f.__assign,c=f.__assign,d=a.hidePivot,e=a.ingressType,g=a.isSingleReview,l=a.asin,q=a.refMarker,n=a.metricsPrefix,
v=a.reviewId,m=JSON,x=m.stringify;var h=a.mediaType===A.VIDEO;h=f.__assign({imageUrl:h?a.thumbnailUrl:a.url,physicalId:a.physicalId},h&&{videoUrl:a.url});a=b.call(f,c.call(f,{hidePivot:d,ingressType:e,isSingleReview:g,productAsin:l,refMarker:q,metricsPrefix:n,reviewId:v,viewData:x.call(m,[h])},a.filter&&{filter:a.filter}),a.mediaType===A.VIDEO?{videoUrl:a.url}:{imageUrl:a.url});return"ssnap://www.amazon.com/ive?"+fb(a)}var H=aa(Za),ib=aa($a),pa=aa(ab),R=aa(cb),S=aa(ia),ja=aa(oa),jb=aa(eb),A;(function(a){a.IMAGE=
"IMAGE";a.VIDEO="VIDEO"})(A||(A={}));var ua=A,va,kb=function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(a){return[2,new Promise(function(b){P.now("mash").execute(function(c){b(c)})})]})})},wa=function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(a){switch(a.label){case 0:return va?[3,2]:[4,kb()];case 1:va=a.sent(),a.label=2;case 2:return[2,va]}})})},lb=function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,
function(a){switch(a.label){case 0:return[4,wa()];case 1:return[2,!!a.sent()]}})})},T;(function(a){a.MWEB="mWeb";a.MSHOP="mShop";a.DESKTOP="desktop"})(T||(T={}));var xa=function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(a){switch(a.label){case 0:return[4,lb()];case 1:return[2,a.sent()]}})})},Ma=function(){return"true"===pa["default"].cardRoot.getAttribute("data-mobile")||ib["default"].isSupported("mobile")},mb=function(){return f.__awaiter(void 0,void 0,
void 0,function(){var a;return f.__generator(this,function(b){switch(b.label){case 0:return(a=Ma())?[4,xa()]:[3,2];case 1:a=!b.sent(),b.label=2;case 2:return[2,a]}})})},Na=function(){return f.__awaiter(void 0,void 0,void 0,function(){var a;return f.__generator(this,function(b){switch(b.label){case 0:return[4,xa()];case 1:if(!b.sent())return[3,2];a=T.MSHOP;return[3,4];case 2:return[4,mb()];case 3:a=b.sent()?T.MWEB:T.DESKTOP,b.label=4;case 4:return[2,a]}})})},K=function(){function a(){}a.setPrefix=
function(b){this.prefix=b+"."};a.logCounter=function(b,c,d){bb.count(""+this.prefix+(d?d+"."+b:b),c)};a.logError=function(b,c){this.logCounter(b,1,c)};a.logNoError=function(b,c){this.logCounter(b,0,c)};a.prefix="";return a}(),ya;(ya||(ya={})).clickHandler="CRImageThumbnailOpsClickHandler";var nb=ya,za;(za||(za={})).clickHandler="CRSeeMoreThumbnailOpsClickHandler";var ob=za,Aa;(Aa||(Aa={})).clickHandler="CRVideoThumbnailClickHandler";var pb=Aa,U;(function(a){a.IMAGE="image";a.VIDEO="video";a.ALL="all"})(U||
(U={}));var qa=function(){function a(b,c){this.popover=c;this.popoverOpenEventType="a-modal"===b?"afterShow":"afterSlide"}a.prototype.showSync=function(){var b=this;return new Promise(function(c){P.when("A").execute(function(d){var e="a:popover:"+b.popoverOpenEventType+":"+b.popover.name,g=function(){d.off(e,g);c()};d.on(e,g);b.show()})})};a.prototype.show=function(){this.popover.show()};a.prototype.hide=function(){this.popover.hide()};a.prototype.updatePosition=function(){this.popover.updatePosition()};
a.getPopoverByName=function(b){return this.popovers[b]};a.prototype.isOpen=function(){return this.popover.isActive()};a.createOrGet=function(b,c,d,e,g){var l=this;return new Promise(function(q){l.popovers[c]?q(l.popovers[c]):P.when(b).execute(function(n){pa["default"].scopeElement(d);n=n.create(e,g);l.popovers[c]=new a(b,n);q(l.popovers[c])})})};a.popovers={};return a}(),qb={activate:"onclick",dataStrategy:"preload",hideHeader:!0,padding:"none"},Oa={dataStrategy:"preload"},rb=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}f.__extends(b,a);b.get=function(c,d,e,g){g=g?f.__assign(f.__assign({},g),{name:c}):f.__assign(f.__assign({},qb),{name:c});return a.createOrGet.call(this,"a-secondary-view",c,d,e,g)};return b}(qa),Pa=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}f.__extends(b,a);b.get=function(c,d,e,g){g=g?f.__assign(f.__assign({},g),{name:c}):f.__assign(f.__assign({},Oa),{name:c});return a.createOrGet.call(this,"a-modal",c,d,e,g)};return b}(qa),sb=function(a){function b(){return null!==
a&&a.apply(this,arguments)||this}f.__extends(b,a);b.get=function(c,d,e,g){g=g?f.__assign(f.__assign({},g),{name:c}):f.__assign(f.__assign({},Oa),{name:c});return a.createOrGet.call(this,"a-popover",c,d,e,g)};return b}(qa),D=function(a){a.style.display="flex"},B=function(a){a.style.display="none"},L;(function(a){a[a.LEFT=0]="LEFT";a[a.CENTER=1]="CENTER";a[a.RIGHT=2]="RIGHT";a[a.NONE=3]="NONE"})(L||(L={}));var ea;(function(a){a[a.EXPAND=0]="EXPAND";a[a.HIDE=1]="HIDE"})(ea||(ea={}));var ka;(function(a){a[a.POTRAIT=
0]="POTRAIT";a[a.LANDSCAPE=1]="LANDSCAPE"})(ka||(ka={}));var G=function(a,b){return(a=null===a||void 0===a?void 0:a.getElementsByClassName(b))?a[0]:null},ra=function(a,b){var c;return null!==(c=null===a||void 0===a?void 0:a.querySelector(b))&&void 0!==c?c:null},u=function(a,b){a&&b(a)},Qa=function(a){a=a.dataset;return{asin:a.asin,mediaType:A[a.mediatype],reviewId:a.reviewid,mediaId:a.physicalid||a.mediaid}},Ra=function(a,b){null===b||void 0===b?void 0:b.classList.remove(a)},Sa=function(a,b){null===
b||void 0===b?void 0:b.classList.add(a)},tb=function(a){var b=G(a,"_Y3Itb_desktop-skeleton-container_738lf"),c=G(a,"_Y3Itb_desktop-spinner-container_1qNHr");return{show:function(){return u(b,function(d){return D(d)})},hide:function(){return u(b,function(d){return B(d)})},setLoadingAnimation:function(d){u(c,function(e){d?b&&D(e):B(e)})}}},Ba;(function(a){a.ProfileBlock="ProfileBlock";a.ProfileBadge="ProfileBadge";a.Rating="Rating";a.ReviewText="ReviewText";a.ReviewTitle="ReviewTitle";a.MainMedia="MainMedia";
a.ImageThumbnailsBlock="ImageThumbnailsBlock";a.GalleryBlock="GalleryBlock";a.SingleReviewMediaBlock="SingleReviewMediaBlock"})(Ba||(Ba={}));var C=Ba,Ca;(function(a){a.THANKYOU_MESSAGE_TOAST_BAR_NAME="thankYouMessageToastBarName";a.ERROR_MESSAGE_TOAST_BAR_NAME="errorMessageToastBarName";a.LOADPOPOVER_ERROR_TOAST_BAR_NAME="loadPopoverErrorToastBarName";a.DATA_POPOVER_NAME="data-popovername";a.DATA_ASIN="data-asin";a.DATA_MEDIATYPE="data-mediatype";a.DATA_SHOW_GALLERY_IN_MODAL="data-showgalleryinmodal";
a.DATA_REVIEW_ID="data-reviewid";a.DATA_MEDIA_ID="data-mediaid";a.DATA_CSA_C_TYPE="data-csa-c-type";a.DATA_CSA_SLOT_ID="data-csa-c-slot-id"})(Ca||(Ca={}));var E=Ca,Da;(function(a){a.showMediaGalleryClickHandler="showMediaGalleryClickHandler";a.galleryItemClickHandler="galleryItemClickHandler";a.thumbnailClickHandler="thumbnailClickHandler";a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.reloadMediaPopover="reloadMediaPopover";a.leftClickHandler="leftClickHandler";
a.rightClickHandler="rightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.mouseMovementHandler="MouseMovementHanler"})(Da||(Da={}));var I=Da,M;(function(a){a.UPDATE_TEXT="updateText";a.REPLACE_CLASS="replaceClass";a.DELETE_CHILDREN="deleteChildren";a.APPEND_ELEMENT="appendElement";a.UPDATE_ELEMENT="UpdateElement"})(M||
(M={}));var Ta=function(a){var b=S["default"].cardRoot.ownerDocument.createElement(a.tag);u(a.elementAttributes,function(c){Object.keys(c).forEach(function(d){return b.setAttribute(d,c[d])})});u(a.children,function(c){c.forEach(function(d){d=Ta(d);b.append(d)})});u(a.observer,function(c){c.observe(b)});u(a.clickHandler,function(c){c(b)});u(a.textContent,function(c){return b.textContent=c});return b},Ua=function(a,b){switch(b.type){case M.UPDATE_TEXT:u(a,function(c){var d,e=null!==(d=b.textContent)&&
void 0!==d?d:"";c.textContent=e});break;case M.REPLACE_CLASS:u(a,function(c){u(b.classPatternToBeReplaced,function(d){var e=Array.from(c.classList).find(function(g){return g.match(d)});u(e,function(g){return c.classList.remove(g)})});u(b.newClass,function(d){return c.classList.add(d)})});break;case M.APPEND_ELEMENT:u(a,function(c){var d;null===(d=b.elements)||void 0===d?void 0:d.forEach(function(e){c.append(Ta(e))})});break;case M.DELETE_CHILDREN:u(a,function(c){for(;c.lastElementChild;)c.removeChild(c.lastElementChild)});
break;case M.UPDATE_ELEMENT:u(a,function(c){u(b.elementAttributes,function(d){Object.keys(d).forEach(function(e){return c.setAttribute(e,d[e])})})})}},Va=function(a,b){a&&b.forEach(function(c){var d=c.querySelector,e=ra(a,"[data-reviewbind="+C[c.key]+"]");d&&e&&(e=ra(e,d));Ua(e,c)})},ub=function(a,b){var c=b==A.IMAGE?"cm_cr_image_carousel_popover":"cm_cr_video_carousel_popover",d=H["default"].setup(),e=function(h,p){var k,w=null!==(k=p.mediaList.findIndex(b==A.IMAGE?function(z){var r;return(null===
(r=z.image)||void 0===r?void 0:r.physicalId)==h}:function(z){var r;return(null===(r=z.video)||void 0===r?void 0:r.physicalId)==h}))&&void 0!==k?k:0;return p.mediaList[w]},g=function(h,p,k){return[{type:M.UPDATE_TEXT,key:h,textContent:p,querySelector:k}]},l=function(h,p,k,w){return[{type:M.REPLACE_CLASS,key:h,classPatternToBeReplaced:p,newClass:k,querySelector:w}]},q=function(h,p,k){return[{key:h,type:M.UPDATE_ELEMENT,elementAttributes:p,querySelector:k}]},n=["_Y3Itb_media-popover-image-view-container_vTrQA",
"_Y3Itb_media-popover-image-view-active_2lj7U"],v=function(h){var p=h.mediaGroup.mediaList.map(function(k){return b==A.IMAGE?k.image:k.video}).filter(function(k){return!!k}).map(function(k,w){var z,r=f.__assign,t=(z={class:h.mediaId==k.physicalId?n.join(" "):"_Y3Itb_media-popover-image-view-container_vTrQA"},z[E.DATA_MEDIA_ID]=k.physicalId,z);z=c+"_"+h.reviewId+"_"+h.reviewRank+"_"+k.physicalId+"_"+w;var y;w=(y={},y[E.DATA_CSA_C_TYPE]="element",y[E.DATA_CSA_SLOT_ID]=z,y);return{tag:"div",elementAttributes:r.call(f,
t,w),children:[{tag:b==A.IMAGE?"img":"video",elementAttributes:f.__assign({src:k.url,alt:k.altText,class:"_Y3Itb_media-popover-image-view_1FAQo"},b==A.VIDEO?{controls:"true"}:{})}]}});return[{type:M.DELETE_CHILDREN,key:C.MainMedia},{type:M.APPEND_ELEMENT,elements:p,key:C.MainMedia}]},m=function(h){if(b==A.VIDEO)return[];var p=h.mediaGroup.mediaList.map(function(k){return k.image}).filter(function(k){return!!k}).map(function(k){var w;return{tag:"span",elementAttributes:(w={class:h.mediaId===k.physicalId?
"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O":""},w[E.DATA_MEDIA_ID]=k.physicalId,w[E.DATA_MEDIATYPE]=b,w),children:[{tag:"img",elementAttributes:{src:k.thumbnailUrl,alt:k.altText,class:"_Y3Itb_media-popover-thumbnail-image-view_3-Y40"}}],clickHandler:function(z){return d.attach(I.thumbnailClickHandler,z)}}});return[{type:M.DELETE_CHILDREN,key:C.ImageThumbnailsBlock},{type:M.APPEND_ELEMENT,elements:p,key:C.ImageThumbnailsBlock}]},x=function(h,p,k){var w,z,r,t;switch(h){case C.ReviewText:return g(h,
null===(z=k.metadata)||void 0===z?void 0:z.text);case C.ReviewTitle:return g(h,null===(r=k.metadata)||void 0===r?void 0:r.title);case C.ProfileBadge:return g(h,p.mediaGroup.contributorRelationships);case C.Rating:return l(h,"^a-star-.*","a-star-"+(null===(t=k.metadata)||void 0===t?void 0:t.rating));case C.MainMedia:return v(p);case C.ProfileBlock:h=p.mediaGroup.contributor.profile;var y;h=h?f.__spread(g(C.ProfileBlock,h.profileName,".a-profile-name"),q(C.ProfileBlock,{src:h.profileAvatarUrl},".a-profile-avatar > img"),
q(C.ProfileBlock,{href:null!==(y=h.profileLink)&&void 0!==y?y:"javascript:void(0)"},"a.a-profile")):[];return h;case C.ImageThumbnailsBlock:return m(p);case C.SingleReviewMediaBlock:return q(h,(w={},w[E.DATA_CSA_SLOT_ID]=c+"_"+p.reviewId+"_"+p.reviewRank,w));default:return[]}};return{updateReview:function(h){var p=e(h.mediaId,h.mediaGroup),k=Object.keys(C).flatMap(function(w){return x(C[w],h,p)});Va(a,k)},updateMedia:function(h){h=f.__spread(l(C.ImageThumbnailsBlock,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",
void 0,"._Y3Itb_media-popover-thumbnail-image-view-active_2W42O"),l(C.ImageThumbnailsBlock,void 0,"_Y3Itb_media-popover-thumbnail-image-view-active_2W42O",'span[data-mediaid="'+h+'"]'),l(C.MainMedia,"_Y3Itb_media-popover-image-view-active_2lj7U",void 0,"._Y3Itb_media-popover-image-view-active_2lj7U"),l(C.MainMedia,void 0,"_Y3Itb_media-popover-image-view-active_2lj7U",'div[data-mediaid="'+h+'"]'));Va(a,h)}}},Ea=function(a,b){if(!a)return!1;b=b.some(function(c){return a.classList.contains(c)});return a.offsetHeight<
a.scrollHeight&&b},vb=function(a){var b=["_Y3Itb_cr-sidepanel-truncated-text_3nfmo","_Y3Itb_cr-sidepanel-truncated-title_2w0Qj"],c=G(a,"_Y3Itb_cr-media-popover-sidepanel-header-section_3TxI7"),d=G(c,"_Y3Itb_cr-sidepanel-text_3MYCz"),e=G(c,"_Y3Itb_cr-sidepanel-title_EX93d"),g=G(c,"_Y3Itb_cr-sidepanel-expander-see-more_1sipE"),l=G(c,"_Y3Itb_cr-sidepanel-expander-see-less_1Hpji"),q=G(c,"_Y3Itb_cr-sidepanel-container-gradient_1zm2j"),n=function(k){Ea(k,b)&&(u(g,function(w){return D(w)}),u(q,function(w){return Sa("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",
w)}))},v=new ResizeObserver(function(k){var w;try{for(var z=f.__values(k),r=z.next();!r.done;r=z.next())n(r.value.target)}catch(y){var t={error:y}}finally{try{r&&!r.done&&(w=z.return)&&w.call(z)}finally{if(t)throw t.error;}}});u(d,function(k){v.observe(ia.unscope(k))});u(e,function(k){v.observe(ia.unscope(k))});var m=function(){h(!0);u(g,function(k){return B(k)});u(l,function(k){return D(k)})},x=function(){h(!1);u(l,function(k){return B(k)})},h=function(k){p("_Y3Itb_cr-media-popover-sidepanel-header-section-truncated_DITiq",
k,c);p("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",k,q);p("_Y3Itb_cr-sidepanel-truncated-text_3nfmo",k,d);p("_Y3Itb_cr-sidepanel-truncated-title_2w0Qj",k,e)},p=function(k,w,z){w?u(z,function(r){return Ra(k,r)}):u(z,function(r){return Sa(k,r)})};return{toggleText:function(){d&&Ea(d,b)||e&&Ea(e,b)?m():x()},hideText:x,expandText:m,initialize:function(){u(g,function(k){return B(k)});u(q,function(k){return Ra("_Y3Itb_cr-sidepanel-container-gradient-truncated_3zXR9",k)});n(d);n(e)}}},Fa=function(){function a(b){this.actionButtons=
b}a.getActionButtonsContainer=function(b){var c=S["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_cr-vote-report-buttons-container_1YjZZ");return Array.from(c).filter(function(d){return d.dataset.id===b})[0]};a.prototype.likeButtonClicked=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];B(b);D(c)};a.prototype.resetLike=function(){var b=this.actionButtons.querySelectorAll("div[data-variant='like']")[0],
c=this.actionButtons.querySelectorAll("div[data-variant='like-done']")[0];B(c);D(b)};return a}(),wb={dataStrategy:"inline",activate:"onclick",position:"triggerVertical"},xb=function(a){var b;return{openTooltipPopover:function(c){return f.__awaiter(void 0,void 0,void 0,function(){var d,e,g;return f.__generator(this,function(l){switch(l.label){case 0:if(b)return[3,2];d="reportAbusePreload_"+a;e=G(c,"_Y3Itb_cr-report-abuse-preload-content_ve26F");null===e||void 0===e?void 0:e.classList.remove("aok-hidden");
g=f.__assign(f.__assign({},wb),{name:d,content:e});return e?[4,sb.get(d,e,c,g)]:[3,2];case 1:b=l.sent(),l.label=2;case 2:return b&&b.show(),[2]}})})},closeTooltipPopover:function(){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(c){b&&b.hide();return[2]})})},isOpen:function(){return b?b.isOpen():!1}}},yb=function(a){var b=(a=G(a,"_Y3Itb_cr-vote-report-buttons-container_1YjZZ"))?new Fa(a):void 0,c=new Set;return{initialize:function(d){c.has(d)?null===b||void 0===
b?void 0:b.likeButtonClicked():null===b||void 0===b?void 0:b.resetLike()},addReviewId:function(d){null===b||void 0===b?void 0:b.likeButtonClicked();c.add(d)}}},zb=function(a,b){var c=G(a,"_Y3Itb_left-icon-container_31i2O"),d=G(a,"_Y3Itb_right-icon-container_3Qopb");return{initialize:function(e,g){u(c,D);u(d,D);b.isFirstMediaItem(e,g)&&u(c,B);b.isLastMediaItem(e,g)&&u(d,B)},hideButtons:function(){u(c,B);u(d,B)}}},Ab=function(a,b,c){a=G(a,"_Y3Itb_modal-content-container_XXRsT");var d=G(a,"_Y3Itb_cr-action-buttons-container_3vmwq"),
e=zb(a,b),g=xb(c);if(!a)throw Error("modalContent element was not found");return{reportAbuse:f.__assign({},g),helpfulVote:f.__assign({},yb(a)),navigation:f.__assign({},e),toggleMediaButtonsVisibility:function(l,q,n){if(l){if(!q||!n)throw Error("reviewId or mediaId not found: "+q+", "+n);u(d,D);e.initialize(q,n)}else g.isOpen()||(u(d,B),e.hideButtons())}}},ba=function(){function a(b,c){var d;this.toastBar=c?a.getToastBarByNameIn(b,c):a.getToastBarByName(b);this.button=null===(d=this.toastBar)||void 0===
d?void 0:d.getElementsByClassName("_Y3Itb_toast-bar-button_1yIpW")[0]}a.getToastBarByName=function(b){return S["default"].cardRoot.ownerDocument.querySelector("div[data-toast-bar-name='"+b+"']")};a.getToastBarByNameIn=function(b,c){return ra(c,"div[data-toast-bar-name='"+b+"']")};a.prototype.setClickParams=function(b){var c=this;b.forEach(function(d,e){var g;null===(g=c.button)||void 0===g?void 0:g.setAttribute(e,d)})};a.prototype.show=function(){u(this.toastBar,D)};a.prototype.hide=function(){u(this.toastBar,
B)};return a}(),Bb=function(a,b,c){var d=ub(b,a),e=vb(b),g=Ab(b,c,a),l=new ba(E.THANKYOU_MESSAGE_TOAST_BAR_NAME,b),q=new ba(E.ERROR_MESSAGE_TOAST_BAR_NAME,b),n=ja["default"].setup(["reportAbuse"]),v=ja["default"].setup(["helpful"]),m={},x=function(r,t){u(r,function(y){m.reviewId=y});u(t,function(y){m.mediaId=y})},h=function(r,t){r=t[r];return a===A.IMAGE?r.image.physicalId:r.video.physicalId},p=function(r){return r.map(function(t){return t.type===A.IMAGE?t.image:t.video}).findIndex(function(t){return(null===
t||void 0===t?void 0:t.physicalId)===m.mediaId})},k=function(){return f.__awaiter(void 0,void 0,void 0,function(){var r;return f.__generator(this,function(t){switch(t.label){case 0:if(!m.reviewId||!m.mediaId)throw Error("No reviewId present: "+m);return[4,c.fetchNextReview(m.reviewId)];case 1:return(r=t.sent())?[4,w(h(0,r.mediaGroup.mediaList),r.mediaGroup.id)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},w=function(r,t){return f.__awaiter(void 0,void 0,void 0,function(){var y,F;return f.__generator(this,
function(ca){switch(ca.label){case 0:return[4,c.fetchReview(t)];case 1:y=ca.sent();if(!y)throw Error("review was not fetched: "+t);F={reviewId:t,mediaId:r,reviewRank:y.reviewRank,mediaGroup:y.mediaGroup};d.updateReview(F);x(t,r);e.hideText();e.initialize();g.helpfulVote.initialize(t);g.navigation.initialize(t,r);return[2]}})})},z=function(r){if(!m.reviewId)throw Error("no reviewId found while updating media: "+m.mediaId);d.updateMedia(r);x(m.reviewId,r);g.navigation.initialize(m.reviewId,r)};return{show:function(){return u(b,
D)},hide:function(){return u(b,B)},update:function(r){var t=r.mediaId,y=r.reviewId;return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(F){switch(F.label){case 0:if(!t||!y)throw Error("reviewId or mediaId not found: "+y+", "+t);return[4,w(t,y)];case 1:return F.sent(),[2]}})})},updateMedia:z,handleModalMediaProgressionClick:function(r){return f.__awaiter(void 0,void 0,void 0,function(){var t,y,F,ca;return f.__generator(this,function(fa){switch(fa.label){case 0:if(!m.reviewId||
!m.mediaId)throw Error("No reviewId or mediaId present: "+m);t=c.getReviewById(m.reviewId);y=p(t.mediaList);F=r;switch(F){case L.RIGHT:return[3,1];case L.LEFT:return[3,5]}return[3,10];case 1:if(!(y<t.mediaList.length-1))return[3,2];z(h(y+1,t.mediaList));return[3,4];case 2:return[4,k()];case 3:fa.sent(),fa.label=4;case 4:return[3,10];case 5:if(!(0<y))return[3,6];z(h(y-1,t.mediaList));return[3,9];case 6:return[4,c.fetchPreviousReview(m.reviewId)];case 7:return(ca=fa.sent())?[4,w(h(ca.mediaGroup.mediaList.length-
1,ca.mediaGroup.mediaList),ca.mediaGroup.id)]:[3,9];case 8:fa.sent(),fa.label=9;case 9:return[3,10];case 10:return[2]}})})},handleExpanderClick:function(r){switch(r){case ea.EXPAND:e.expandText();break;case ea.HIDE:e.hideText()}},handleReportAbuseClick:function(r){return f.__awaiter(void 0,void 0,void 0,function(){var t,y;return f.__generator(this,function(F){switch(F.label){case 0:if(!m.reviewId)throw Error("no reviewId found while reporting abuse: "+m);g.reportAbuse.closeTooltipPopover();F.label=
1;case 1:return F.trys.push([1,5,,6]),[4,n.reportAbuse({reviewId:m.reviewId,asin:r,domain:da()})];case 2:t=F.sent();if(!t.success&&t.redirectUrl)return R["default"].setLocation(t.redirectUrl),[2];if(!t.success)return[3,4];l.show();return[4,k()];case 3:return F.sent(),[2];case 4:return t.success?[3,6]:(q.show(),[2]);case 5:throw y=F.sent(),q.show(),y;case 6:return[2]}})})},handleHelpulVoteClick:function(r){return f.__awaiter(void 0,void 0,void 0,function(){var t,y;return f.__generator(this,function(F){switch(F.label){case 0:if(!m.reviewId)throw Error("no reviewId found while handling helpfulvote call: "+
m);F.label=1;case 1:return F.trys.push([1,3,,4]),[4,v.helpful({reviewId:m.reviewId,domain:da(),asin:r})];case 2:return t=F.sent(),!t.success&&t.redirectUrl&&R["default"].setLocation(t.redirectUrl),t.success?(g.helpfulVote.addReviewId(m.reviewId),[2]):t.success?[3,4]:(q.show(),[2]);case 3:throw y=F.sent(),q.show(),y;case 4:return[2]}})})},openReportAbuseTooltip:g.reportAbuse.openTooltipPopover,toggleMediaButtonsVisibility:function(r){g.toggleMediaButtonsVisibility(r,m.reviewId,m.mediaId)},getCurrentReviewDetails:function(){return m},
updateReviewDetails:x}},Cb=H["default"].setup(),Db=function(a){var b=0,c=function(q,n,v){var m;return m={},m[E.DATA_MEDIA_ID]=q,m[E.DATA_MEDIATYPE]=v,m[E.DATA_REVIEW_ID]=n,m[E.DATA_SHOW_GALLERY_IN_MODAL]="false",m},d=function(q){var n;return n={},n[E.DATA_CSA_C_TYPE]="element",n[E.DATA_CSA_SLOT_ID]=q,n},e=function(q){return[{tag:"img",elementAttributes:{src:q.thumbnailUrl,alt:q.altText}}]},g=function(q,n){var v={tag:"img",elementAttributes:{src:q.thumbnailUrl,alt:q.altText}};return n?[v,{tag:"div",
elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay-container_RHWdX"},children:[{tag:"div",elementAttributes:{class:"_Y3Itb_media-gallery-item-video-overlay_cGzRu"},children:[{tag:"i",elementAttributes:{"class":"a-icon a-icon-star-mini a-star-mini-"+n.rating}},{tag:"span",textContent:"\u25b7 "+q.videoDuration}]}]}]:[v]},l=function(q,n,v,m,x){return q.map(function(h,p){var k,w=h.type==ua.IMAGE?h.image:h.video;if(w){var z=h.type==ua.IMAGE?e(h.image):g(h.video,h.metadata),r=null===(k=h.metadata)||
void 0===k?void 0:k.contributionId;if(r)return{tag:"div",elementAttributes:f.__assign(f.__assign({class:h.type==ua.IMAGE?"_Y3Itb_media-gallery-item_3LROo":"_Y3Itb_media-gallery-item-video_1k9yY"},c(w.physicalId,r,h.type)),d(x+"_"+r+"_"+w.physicalId+"_"+m)),observer:p==n?v:void 0,children:f.__spread(z),clickHandler:function(t){return Cb.attach(I.galleryItemClickHandler,t)}}}}).filter(function(h){return void 0!==h})};return{updateGallery:function(q,n,v,m){q=l(q,n,v,b,m);b++;0<q.length&&Ua(a,{type:M.APPEND_ELEMENT,
key:C.GalleryBlock,elements:q})}}},Eb=function(a,b,c){var d=G(b,"_Y3Itb_media-popover-gallery-container-grid_mLjpJ"),e=G(b,"_Y3Itb_gallery-spinner_34BcK"),g=a===A.IMAGE?"cm_cr_image_gallery_popover":"cm_cr_video_gallery_popover",l=new IntersectionObserver(function(m,x){m.forEach(function(h){return f.__awaiter(void 0,void 0,void 0,function(){var p;return f.__generator(this,function(k){switch(k.label){case 0:if(!h.isIntersecting)return[3,4];k.label=1;case 1:return k.trys.push([1,3,,4]),u(e,D),[4,c.fetchReviewsNextPage()];
case 2:return k.sent(),v(),u(e,B),x.unobserve(h.target),[3,4];case 3:throw p=k.sent(),p;case 4:return[2]}})})})},{root:ia.unscope(d),rootMargin:"0px",threshold:.25}),q=Db(d),n=0,v=function(){for(var m=c.getAllReviews(),x=c.getAllReviewIds(),h=[],p=n;p<x.length;p++)h.push.apply(h,f.__spread(m[x[p]].mediaList)),n++;q.updateGallery(h,5<=h.length?h.length-5:-1,l,g)};return{hide:function(){return u(b,B)},show:function(){return u(b,D)},update:function(){return f.__awaiter(void 0,void 0,void 0,function(){var m;
return f.__generator(this,function(x){switch(x.label){case 0:return m=c.getAllReviewIds(),0!=m.length?[3,2]:[4,c.fetchReviewsNextPage()];case 1:x.sent(),x.label=2;case 2:return v(),[2]}})})},scrollToMediaId:function(m){m&&(m=ra(b,'div[data-mediaid="'+m+'"]'),u(m,function(x){return x.scrollIntoView()}))}}},Fb=function(a){var b=G(a,"_Y3Itb_media-popover-see-all-container_1Lmmi");return{show:function(){return u(b,function(c){return D(c)})},hide:function(){return u(b,function(c){return B(c)})}}},Gb=function(a,
b){var c=[],d={},e,g,l=function(){return f.__awaiter(void 0,void 0,void 0,function(){var h,p;return f.__generator(this,function(k){switch(k.label){case 0:return h=oa.setup(["getGroupedMediaReviews"]),[4,h.getGroupedMediaReviews({asin:a,nextToken:e,mediaType:b,limit:50})];case 1:return p=k.sent(),q(p.mediaGroupList),e=p.nextToken,[2]}})})},q=function(h){h.forEach(function(p){d[p.id]=p;0>c.indexOf(p.id)&&c.push(p.id)})},n=function(h){return!!d[h]},v=function(h){return c.indexOf(h)},m=function(){return f.__awaiter(void 0,
void 0,void 0,function(){var h;return f.__generator(this,function(p){switch(p.label){case 0:h=0===Object.keys(d).length;if(!h&&(h||g||!e))return[3,5];p.label=1;case 1:return p.trys.push([1,,3,4]),[4,l()];case 2:return p.sent(),[3,4];case 3:return g=!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})},x=function(h,p){return d[h].mediaList.map(function(k){return k.type===A.IMAGE?k.image:k.video}).findIndex(function(k){return(null===k||void 0===k?void 0:k.physicalId)===p})};return{fetchReview:function(h){return f.__awaiter(void 0,
void 0,void 0,function(){var p,k;return f.__generator(this,function(w){switch(w.label){case 0:if(!h)throw Error("fetchReview was called without a reviewId");p=n(h);w.label=1;case 1:return p?[3,3]:[4,m()];case 2:return k=w.sent(),p=n(h),k?[3,1]:[3,3];case 3:return n(h)?[2,{mediaGroup:d[h],reviewRank:v(h)}]:[2]}})})},isReviewFetched:n,fetchReviewsNextPage:m,fetchNextReview:function(h){return f.__awaiter(void 0,void 0,void 0,function(){var p,k;return f.__generator(this,function(w){switch(w.label){case 0:return p=
v(h)+1,p>=c.length?[4,m()]:[3,2];case 1:w.sent(),w.label=2;case 2:return k=c[p],n(k)?[2,{mediaGroup:d[k],reviewRank:p}]:[2]}})})},fetchPreviousReview:function(h){return f.__awaiter(void 0,void 0,void 0,function(){var p,k;return f.__generator(this,function(w){p=v(h)-1;if(0>p)return[2];k=c[p];return n(k)?[2,{mediaGroup:d[k],reviewRank:p}]:[2]})})},getReviewById:function(h){return d[h]},getReviewIndexById:v,getAllReviews:function(){return d},getAllReviewIds:function(){return c},isFirstMediaItem:function(h,
p){var k=v(h);h=x(h,p);return 0===k&&0===h},isLastMediaItem:function(h,p){var k=v(h);p=x(h,p);return!e&&k===c.length-1&&p===d[h].mediaList.length-1}}},la=function(){var a={};return{setData:function(b,c){a[b]=c},getData:function(b){return a[b]},hasData:function(b){return b in a},removeData:function(b){delete a[b]},clearData:function(){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}}}(),Hb=function(a,b,c){var d=Gb(a,b),e=tb(c),g=Fb(c),l=new ba(E.LOADPOPOVER_ERROR_TOAST_BAR_NAME,c),q=G(c,"_Y3Itb_single-review-media-popover-container_1h9X2");
if(!q)throw Error("Unable to find singleReviewMediaPopoverContainer");var n=Bb(b,q,d);c=G(c,"_Y3Itb_gallery-container_2pBFm");if(!c)throw Error("Unable to find mediaGalleryContainer");var v=Eb(b,c,d);return{loadModal:function(m){return f.__awaiter(void 0,void 0,void 0,function(){var x;return f.__generator(this,function(h){switch(h.label){case 0:return l.hide(),n.hide(),v.hide(),e.show(),e.setLoadingAnimation(!0),m.popoverDetails.popover?[4,m.popoverDetails.popover.showSync()]:[3,2];case 1:h.sent(),
h.label=2;case 2:return h.trys.push([2,4,,5]),x=m.showGalleryInModal?v:n,[4,x.update(m)];case 3:return h.sent(),x.show(),m.showGalleryInModal?g.hide():g.show(),e.hide(),[3,5];case 4:h.sent();e.setLoadingAnimation(!1);if(!m.mediaType||!m.asin)throw Error("mediaType or asin was not found while setting parameters for toastbar: "+m.mediaType+", "+m.asin);h=new Map([[E.DATA_POPOVER_NAME,m.popoverDetails.popoverName],[E.DATA_ASIN,m.asin],[E.DATA_MEDIATYPE,m.mediaType.toString()]]);if(m.showGalleryInModal)h.set(E.DATA_SHOW_GALLERY_IN_MODAL,
"true");else{if(!m.reviewId||!m.mediaId)throw Error("mediaId or reviewId was not found while setting parameters for toastbar: "+m.reviewId+", "+m.mediaId);h.set(E.DATA_REVIEW_ID,m.reviewId);h.set(E.DATA_MEDIA_ID,m.mediaId)}l.setClickParams(h);l.show();return[3,5];case 5:return[2]}})})},updateModalWithReview:function(m,x){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(h){switch(h.label){case 0:return v.hide(),g.show(),[4,n.update({reviewId:m,mediaId:x,asin:a,
mediaType:b})];case 1:return h.sent(),n.show(),[2]}})})},showMediaGallery:function(){return f.__awaiter(void 0,void 0,void 0,function(){var m;return f.__generator(this,function(x){switch(x.label){case 0:return m=n.getCurrentReviewDetails().mediaId,n.hide(),g.hide(),e.show(),e.setLoadingAnimation(!0),[4,v.update()];case 1:return x.sent(),e.hide(),v.show(),v.scrollToMediaId(m),[2]}})})},updateMediaInModal:n.updateMedia,handleModalMediaProgressionClick:n.handleModalMediaProgressionClick,handleExpanderClick:n.handleExpanderClick,
openReportAbuseDialog:n.openReportAbuseTooltip,handleReportAbuseClick:function(){return n.handleReportAbuseClick(a)},handleHelpulVoteClick:function(){return n.handleHelpulVoteClick(a)},toggleMediaButtonsVisibility:n.toggleMediaButtonsVisibility}},Ib=function(a){return f.__awaiter(void 0,void 0,void 0,function(){var b;return f.__generator(this,function(c){switch(c.label){case 0:return b=oa.setup(["triggerWeblab"]),[4,b.triggerWeblab({weblabId:a})];case 1:return[2,c.sent()]}})})},Jb=function(){function a(){this.desktopPopoverModalOptions=
{dataStrategy:"preload",hideHeader:!0,closeButton:!1,padding:"none",name:"cr-media-popover"}}a.prototype.onVideoClickHandler=function(b){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(c){throw Error("Video click handler on Desktop is not yet implemented.");})})};a.prototype.onImageClickHandler=function(b){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(c){switch(c.label){case 0:return[4,this.showImagePopover(b,!1)];case 1:return c.sent(),
[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return f.__awaiter(this,void 0,void 0,function(){var d,e,g;return f.__generator(this,function(l){switch(l.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=A[d.mediatype],g=ta(e),g!==U.IMAGE?[3,2]:[4,this.showImagePopover(b,!0)];case 1:return l.sent(),[3,3];case 2:throw K.logError("loadDesktopVideoGalleryError",g),Error("Video gallery is not available on desktop.");case 3:return[2]}})})};a.prototype.showImagePopover=
function(b,c){return f.__awaiter(this,void 0,void 0,function(){var d;return f.__generator(this,function(e){switch(e.label){case 0:return[4,Ib("CM_CR_MEDIA_CAROUSEL_PHOTO_POPOVER_DESKTOP_756292")];case 1:return d=e.sent(),"T1"!==d.treatment?[3,3]:[4,this.openModal(b,c)];case 2:return e.sent(),[3,5];case 3:return[4,this.showImageGallery(b)];case 4:e.sent(),e.label=5;case 5:return[2]}})})};a.prototype.showImageGallery=function(b){return f.__awaiter(this,void 0,void 0,function(){var c,d;return f.__generator(this,
function(e){switch(e.label){case 0:return c=b.currentTarget,[4,Pa.get("widget_customer_image_gallery",c,c)];case 1:return d=e.sent(),d.popover.$trigger.context=c,d.show(),c.classList.remove("a-declarative"),[2]}})})};a.prototype.openModal=function(b,c){return f.__awaiter(this,void 0,void 0,function(){var d,e,g,l,q,n,v,m,x;return f.__generator(this,function(h){switch(h.label){case 0:d=b.currentTarget;e=Qa(d);if(c&&(!e.mediaType||!e.asin))throw Error("media props are missing while trying to load the modal: "+
JSON.stringify(e));if(!(c||e.mediaType&&e.asin&&e.reviewId&&e.mediaId))throw Error("media props are missing while trying to load the modal: "+JSON.stringify(e));g=e.mediaType===A.IMAGE?"_Y3Itb_cm_cr_image_popoversection_3iYPp":"_Y3Itb_cm_cr_video_popoversection_2v7yY";l=pa["default"].cardRoot.getElementsByClassName(g)[0];q=l.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0];n=this.desktopPopoverModalOptions.name+"_"+e.mediaType;v=f.__assign(f.__assign({},this.desktopPopoverModalOptions),
{name:n});return[4,Pa.get(n,q,d,v)];case 1:m=h.sent();x=la.hasData(e.mediaType)?la.getData(e.mediaType):Hb(e.asin,e.mediaType,q);if(!x)throw Error("Could not load ModalManager for opening modal: "+e);return[4,x.loadModal({asin:e.asin,mediaId:e.mediaId,reviewId:e.reviewId,mediaType:e.mediaType,showGalleryInModal:c,popoverDetails:{popoverName:this.desktopPopoverModalOptions.name+"_"+e.mediaType,popover:m}})];case 2:return h.sent(),la.hasData(e.mediaType)||la.setData(e.mediaType,x),m.updatePosition(),
d.classList.remove("a-declarative"),[2]}})})};return a}(),La=function(a,b){a=b?a+". Error object: "+JSON.stringify({message:b.message,name:b.name,stack:b.stack}):a;db.log(a,"FATAL")},V;(function(a){a.CAROUSEL="crsl";a.IMAGES_CAROUSEL="crsl_img";a.VIDEOS_CAROUSEL="crsl_vid"})(V||(V={}));var W;(function(a){a.DETAIL_PAGE_WIDGET="dp";a.IMAGE_GALLERY="img";a.MEDIA_GALLERY="mg";a.OTHER="othr"})(W||(W={}));var X;(function(a){a.SEE_MORE="sm";a.POPOVER="pop";a.IMAGE="img";a.VIDEO="vid"})(X||(X={}));var Y;
(function(a){a.DESKTOP="d";a.MOBILE_APP="ma";a.MOBILE_BROWSER="mb";a.TABLET_APP="ta";a.TABLET_BROWSER="tb";a.UNKNOWN="unkn"})(Y||(Y={}));var ha=function(){function a(b,c,d,e){this.page=b;this.device=c;this.widget=d;this.location=e}a.prototype.toString=function(){return a.PREFIX+a.DELIMITER+this.page+a.DELIMITER+this.device+a.DELIMITER+this.widget+a.DELIMITER+this.location};a.prototype.appendToString=function(b){return b?this.toString()+a.DELIMITER+b:this.toString()};a.MAX_LENGTH=32;a.PREFIX="cm_cr";
a.DELIMITER="_";return a}(),Kb=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_APP,V.CAROUSEL,X.IMAGE),Lb=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_APP,V.CAROUSEL,X.VIDEO),Mb=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_APP,V.IMAGES_CAROUSEL,X.SEE_MORE),Nb=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_APP,V.VIDEOS_CAROUSEL,X.SEE_MORE),Ob=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_BROWSER,V.IMAGES_CAROUSEL,X.SEE_MORE),Pb=new ha(W.DETAIL_PAGE_WIDGET,Y.MOBILE_BROWSER,V.CAROUSEL,X.VIDEO),Qb=function(){function a(){}a.prototype.onVideoClickHandler=
function(b){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){return f.__awaiter(this,void 0,void 0,function(){return f.__generator(this,function(c){switch(c.label){case 0:return[4,this.onMediaClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return f.__awaiter(this,void 0,
void 0,function(){var d,e,g;return f.__generator(this,function(l){switch(l.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=A[d.mediatype],g=ta(e),[4,this.goToGallery(b,g)];case 1:return l.sent(),[2]}})})};a.prototype.onMediaClickHandler=function(b){var c;return f.__awaiter(this,void 0,void 0,function(){var d,e,g,l,q;return f.__generator(this,function(n){switch(n.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=A[d.mediatype],g=d.rank,
l={reviewId:d.reviewid,mediaType:e,url:d.url,thumbnailUrl:d.thumbnailurl,physicalId:d.physicalid,asin:d.asin,isSingleReview:!1,hidePivot:!1,refMarker:a.getIVXRefMarker(e,g),ingressType:"dpreviews",filter:e===A.IMAGE?"image":"video",metricsPrefix:e===A.IMAGE?"CarouselImageToAppX":"CarouselVideoToAppX"},[4,wa()];case 1:return q=n.sent(),[4,gb(q,l)];case 2:return n.sent(),[2]}})})};a.prototype.goToGallery=function(b,c){var d;return f.__awaiter(this,void 0,void 0,function(){var e,g,l,q;return f.__generator(this,
function(n){switch(n.label){case 0:return e=null===(d=b.currentTarget)||void 0===d?void 0:d.dataset,g=e.asin,l=c===U.IMAGE?Mb:Nb,[4,wa()];case 1:return q=n.sent(),q.navigate({url:Ka(l.toString(),c,g),successCallback:function(){K.logNoError("loadMediaGalleryError",c)},failCallback:function(v){La("Failed to load gallery for asin: "+g+".",v);K.logError("loadMediaGalleryError",c)}}),[2]}})})};a.getIVXRefMarker=function(b,c){return(b===A.IMAGE?Kb:Lb).appendToString(c)};return a}(),J=function(){function a(b){var c=
this;this.popover=b;this.loadMediaResources=function(){for(var d=c.popover.querySelectorAll("[data-lazyimagesource]"),e=0;e<d.length;e++){var g=d[e],l=g.getAttribute("data-lazyimagesource");g="img"===g.tagName.toLowerCase()?g:g.getElementsByTagName("img")[0];g.getAttribute("src")!=l&&g.setAttribute("src",l)}};this.getCurrentMediaIndex=function(){for(var d=c.popover.querySelectorAll("[data-mediaid]"),e=0;e<d.length;e++)if("none"!==d[e].style.display)return e;return 0};this.getPreviousPopoverWidget=
function(){return c.popover.previousElementSibling?new a(c.popover.previousElementSibling):null};this.getNextPopoverWidget=function(){return c.popover.nextElementSibling?new a(c.popover.nextElementSibling):null};this.getNumbersOfMedia=function(){return c.popover.querySelectorAll("[data-mediaid]").length};this.toggleOverlay=function(){var d=c.popover.getElementsByClassName("_Y3Itb_overlay-content-container_1ubFP")[0];d.classList.contains("_Y3Itb_media-popover-overlay-fade-out_1eneO")?(d.classList.remove("_Y3Itb_media-popover-overlay-fade-out_1eneO"),
d.classList.add("_Y3Itb_media-popover-overlay-fade-in_bZzwP")):(d.classList.add("_Y3Itb_media-popover-overlay-fade-out_1eneO"),d.classList.remove("_Y3Itb_media-popover-overlay-fade-in_bZzwP"))};this.scrollIntoSelf=function(){c.popover.scrollIntoView()};this.scrollIntoMediaByIndex=function(d){c.scrollIntoSelf();var e=!1;c.popover.querySelectorAll("[data-mediaid]").forEach(function(g,l){e?c.removeHighlightPageIndicator(l):c.addHighlightPageIndicator(l);l==d?(D(g),e=!0):B(g)})};this.scrollIntoMediaId=
function(d){c.scrollIntoSelf();c.popover.querySelectorAll("[data-mediaid]").forEach(function(e,g){e.getAttribute("data-mediaid")===d&&c.scrollIntoMediaByIndex(g)})};this.getReviewId=function(){return c.popover.getAttribute("data-reviewid")};this.getPageIndicator=function(d){var e=c.popover.getElementsByClassName("_Y3Itb_media-popover-page-indicator_36NFP")[0];if(e)return e.childNodes[d]};this.addHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.add("_Y3Itb_highlighted_1QxVg")};
this.removeHighlightPageIndicator=function(d){d=c.getPageIndicator(d);null===d||void 0===d?void 0:d.classList.remove("_Y3Itb_highlighted_1QxVg")}}a.getPopoverWidgetById=function(b){return b?S["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0].querySelector("div[data-reviewid='"+b+"']"):null};a.prototype.handlePopoverClick=function(b){switch(b){case L.LEFT:if(0<this.getCurrentMediaIndex())this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()-
1);else if(b=this.getPreviousPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(b.getNumbersOfMedia()-1);break;case L.CENTER:this.toggleOverlay();break;case L.RIGHT:if(this.getCurrentMediaIndex()<this.getNumbersOfMedia()-1)this.scrollIntoMediaByIndex(this.getCurrentMediaIndex()+1);else if(b=this.getNextPopoverWidget())b.scrollIntoSelf(),b.scrollIntoMediaByIndex(0)}};a.prototype.scrollIntoNextPopover=function(){var b=this.getNextPopoverWidget()||this.getPreviousPopoverWidget();b&&b.scrollIntoSelf()};
return a}(),Q;(function(a){a.closePopoverClickHandler="ClosePopoverClickHandler";a.popoverClickHandler="PopoverClickHandler";a.desktopLeftClickHandler="DesktopLeftClickHandler";a.desktopRightClickHandler="DesktopRightClickHandler";a.openReportConfirmationDialogClickHandler="OpenReportConfirmationDialogClickHandler";a.helpfulVoteClickHandler="HelpfulVoteClickHandler";a.confirmReportAbuseClickHandler="ConfirmReportAbuseClickHandler";a.noopHandler="noopHandler";a.loadMediaPopover="loadMediaPopover";
a.closePopoverErrorDialogClickHandler="ClosePopoverErrorDialogClickHandler"})(Q||(Q={}));var Rb=function(){function a(b){this.popover=b;b=b.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0];this.text=b.querySelector("._Y3Itb_cr-text_28H9k");this.title=b.querySelector("._Y3Itb_cr-title_3bWqW");this.expandButton=b.querySelector("._Y3Itb_cr-text-expand-button_2BWKW");this.hideButton=b.querySelector("._Y3Itb_cr-text-hide-button_2qNi2")}a.prototype.toggleElementExpansion=function(b,
c){c?(b.classList.remove("_Y3Itb_truncated_j_-Jw"),b.classList.add("_Y3Itb_expanded_2wQ4c")):(b.classList.remove("_Y3Itb_expanded_2wQ4c"),b.classList.add("_Y3Itb_truncated_j_-Jw"))};a.prototype.initResizeObserver=function(){var b=this;if(this.title||this.text)this.observer=new ResizeObserver(function(c){var d;try{for(var e=f.__values(c),g=e.next();!g.done;g=e.next())a.isTruncated(g.value.target,"_Y3Itb_truncated_j_-Jw")&&D(b.expandButton)}catch(q){var l={error:q}}finally{try{g&&!g.done&&(d=e.return)&&
d.call(e)}finally{if(l)throw l.error;}}}),this.title&&this.observer.observe(this.title),this.text&&this.observer.observe(this.text)};a.prototype.expandText=function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")&&this.toggleElementExpansion(this.text,!0);this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")&&this.title.classList.remove("_Y3Itb_truncated_j_-Jw");B(this.expandButton);D(this.hideButton);this.setPopoverOverlayGradient(!0);this.showActionButtons(!1)};a.prototype.toggleText=
function(){this.text&&a.isTruncated(this.text,"_Y3Itb_truncated_j_-Jw")||this.title&&a.isTruncated(this.title,"_Y3Itb_truncated_j_-Jw")?this.expandText():this.hideText()};a.prototype.hideText=function(){this.text&&(this.text.offsetHeight<this.text.scrollHeight&&(this.text.scrollTop=0),this.toggleElementExpansion(this.text,!1));this.title&&this.title.classList.add("_Y3Itb_truncated_j_-Jw");B(this.hideButton);this.setPopoverOverlayGradient(!1);this.showActionButtons(!0)};a.prototype.setPopoverOverlayGradient=
function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-media-popover-overlay-container_32qUq")[0];c&&(b?(c.classList.add("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations=Q.noopHandler):c.classList.contains("_Y3Itb_popover-overlay-gradient_114MI")&&(c.classList.remove("_Y3Itb_popover-overlay-gradient_114MI"),c.dataset.mixOperations&&delete c.dataset.mixOperations))};a.prototype.showActionButtons=function(b){var c=this.popover.getElementsByClassName("_Y3Itb_cr-action-buttons-container_28a_m")[0];
c&&(b?D(c):B(c))};a.isTruncated=function(b,c){return b&&b.offsetHeight<b.scrollHeight&&b.classList.contains(c)};return a}(),Ga=function(a){if(a)return(null===a||void 0===a?0:a.getElementsByClassName("_Y3Itb_cr-popover-overlay-text-container_NfghQ")[0])?new Rb(a):void 0},Sb=function(){return function(){var a=this;this.show=function(){D(a.popoverList)};this.hide=function(){B(a.popoverList)};this.getNumberOfPopoversLoaded=function(){return a.popoverList.childNodes.length};this.getNumberOfPopoversLeft=
function(){if(a.currentReviewId){var b=0;a.popoverList.childNodes.forEach(function(c,d){c.getAttribute("data-reviewid")==a.currentReviewId&&(b=a.getNumberOfPopoversLoaded()-d)});return b}return a.popoverList.childNodes.length};this.addPopovers=function(b){b.querySelectorAll("._Y3Itb_media-popover-container_15D5F").forEach(function(c){c=ia.unscope(c);var d=c.getAttribute("data-reviewid");J.getPopoverWidgetById(d)||(a.popoverList.appendChild(c),a.observer.observe(c),c=Ga(J.getPopoverWidgetById(d)),
null===c||void 0===c?void 0:c.initResizeObserver())})};this.scrollTo=function(b,c){a.setCurrentReviewId(b);b=J.getPopoverWidgetById(b);(new J(b)).scrollIntoMediaId(c)};this.setCurrentReviewId=function(b){a.currentReviewId=b};this.doesPopoverExists=function(b){return null!=J.getPopoverWidgetById(b)};this.getNextToken=function(){return a.popoverList.getAttribute("data-next-token")};this.setNextToken=function(b){return a.popoverList.setAttribute("data-next-token",b)};this.setOnScrollCallback=function(b){a.onScrollCallback=
b};this.popoverList=S["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-list-container_3mcnh")[0];this.observer=new IntersectionObserver(function(b){b.forEach(function(c){if(c.isIntersecting){c=new J(c.target);var d=c.getReviewId(),e=a.currentReviewId;a.setCurrentReviewId(d);if(a.onScrollCallback)a.onScrollCallback(d);c.loadMediaResources();c=Ga(J.getPopoverWidgetById(e));null===c||void 0===c?void 0:c.hideText()}})},{threshold:.5})}}(),sa=function(){function a(){this.confirmationDialog=
S["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog_7HNIt");this.confirmButton=S["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-report-abuse-confirmation-dialog-button_35f75")}a.prototype.setReviewId=function(b){this.confirmButton.dataset.id=b};a.prototype.setAsin=function(b){this.confirmButton.dataset.asin=b};a.prototype.show=function(){D(this.confirmationDialog)};a.prototype.hide=function(){B(this.confirmationDialog)};
return a}(),Wa=function(){function a(){this.popoverSkeleton=S["default"].cardRoot.ownerDocument.getElementsByClassName("_Y3Itb_media-popover-skeleton-container_3DI7n")[0];this.profileSkeleton=this.popoverSkeleton.getElementsByClassName("_Y3Itb_profile-skeleton_1JfdD")[0]}a.prototype.show=function(){D(this.popoverSkeleton)};a.prototype.hide=function(){B(this.popoverSkeleton)};a.prototype.setLoadingAnimation=function(b){b?this.profileSkeleton.classList.add("_Y3Itb_loading_3908t"):this.profileSkeleton.classList.contains("_Y3Itb_loading_3908t")&&
this.profileSkeleton.classList.remove("_Y3Itb_loading_3908t")};return a}(),Z;(function(a){a[a.Popover=0]="Popover";a[a.Gallery=1]="Gallery";a[a.ReportAbuseConfirmationDialog=2]="ReportAbuseConfirmationDialog"})(Z||(Z={}));var ma=function(){function a(){}a.getInstance=function(){a.instance||(a.instance=new a);return a.instance};a.prototype.initPopoverWidgetList=function(){null==this.popoverWidgetList&&(this.popoverWidgetList=new Sb);return this.popoverWidgetList};a.prototype.initPopoverSkeletonClient=
function(){this.popoverSkeleton=new Wa};a.prototype.initPopover=function(b){a.currentScreen=Z.Popover;a.popoverName=b;this.resetOverlayComponents();this.initPopoverWidgetList();this.initPopoverSkeletonClient()};a.prototype.loadMediaPopover=function(b){return f.__awaiter(this,void 0,void 0,function(){var c,d,e,g,l,q=this;return f.__generator(this,function(n){switch(n.label){case 0:return this.initPopover(b.popoverDetails.popoverName),this.popoverSkeleton.show(),this.popoverWidgetList.hide(),this.popoverSkeleton.setLoadingAnimation(!0),
b.popoverDetails.popover?[4,b.popoverDetails.popover.showSync()]:[3,2];case 1:n.sent(),n.label=2;case 2:c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d=0,n.label=3;case 3:n.trys.push([3,7,,8]),n.label=4;case 4:if(c)return[3,6];e=0===d;return[4,this.fetchAnotherPopoversPage(b.asin,b.mediaType,e)];case 5:return g=n.sent(),c=this.popoverWidgetList.doesPopoverExists(b.reviewId),d++,g?[3,4]:[3,6];case 6:return this.popoverWidgetList.show(),c&&this.popoverWidgetList.scrollTo(b.reviewId,b.mediaId),
this.popoverSkeleton.hide(),[3,8];case 7:return n.sent(),this.popoverSkeleton.setLoadingAnimation(!1),l=new ba("loadPopoverError"),l.setClickParams(new Map([["data-popovername",b.popoverDetails.popoverName],["data-asin",b.asin],["data-mediatype",b.mediaType.toString()],["data-reviewid",b.reviewId],["data-mediaid",b.mediaId]])),l.show(),[3,8];case 8:return this.popoverWidgetList.setOnScrollCallback(function(){5>=q.popoverWidgetList.getNumberOfPopoversLeft()&&q.fetchAnotherPopoversPage(b.asin,b.mediaType)}),
[2]}})})};a.prototype.resetOverlayComponents=function(){(new sa).hide();(new ba("loadPopoverError")).hide();(new ba("reportAbuseThankYouMessage")).hide()};a.prototype.showReportAbuseConfirmationDialog=function(b,c){a.currentScreen=Z.ReportAbuseConfirmationDialog;var d=new sa;d.setReviewId(b);d.setAsin(c);d.show()};a.prototype.back=function(){switch(a.currentScreen){case Z.Popover:case Z.Gallery:qa.getPopoverByName(a.popoverName).hide();break;case Z.ReportAbuseConfirmationDialog:(new sa).hide(),a.currentScreen=
Z.Popover}};a.prototype.fetchAnotherPopoversPage=function(b,c,d){void 0===d&&(d=!1);return f.__awaiter(this,void 0,void 0,function(){var e,g;return f.__generator(this,function(l){switch(l.label){case 0:e=this.popoverWidgetList.getNumberOfPopoversLoaded();g=this.popoverWidgetList.getNextToken();if(!(d||!this.isAlreadyLoadingMedia&&g&&500>=e))return[3,5];this.isAlreadyLoadingMedia=!0;l.label=1;case 1:return l.trys.push([1,,3,4]),[4,this.loadPopovers(b,c,g)];case 2:return l.sent(),[3,4];case 3:return this.isAlreadyLoadingMedia=
!1,[7];case 4:return[2,!0];case 5:return[2,!1]}})})};a.prototype.loadPopovers=function(b,c,d){return f.__awaiter(this,void 0,void 0,function(){var e,g;return f.__generator(this,function(l){switch(l.label){case 0:return e=oa.setup(["renderPopoverList"]),[4,e.renderPopoverList({asin:b,nextToken:d,mediaType:c,limit:50})];case 1:return g=l.sent(),this.popoverWidgetList.addPopovers(g),d=g.getAttribute("data-next-token"),this.popoverWidgetList.setNextToken(d),[2,d]}})})};return a}().getInstance(),Tb=function(){function a(){}
a.prototype.onVideoClickHandler=function(b){var c;return f.__awaiter(this,void 0,void 0,function(){var d,e,g,l,q,n,v;return f.__generator(this,function(m){d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=d.asin;g=d.physicalid;l=d.reviewid;q=d.extension;n=d.thumbnailurl;v=this.getRefMarker(d.rank);jb["default"].trigger("a:declarative:reviews:open-mweb-immersive-video-modal:click",{$event:b.event,$target:b.currentTarget,data:{asin:e,filter:"video",isSingleReview:!0,mediaType:"video",metricsPrefix:"CarouselVideoToAppX",
physicalId:g,refMarker:v,reviewId:l,shouldTriggerRefTag:!0,slateImageUrl:n,url:"https://m.media-amazon.com/images/I/"+g+"."+q}});return[2]})})};a.prototype.onImageClickHandler=function(b){this.onMediaClickHandler(b)};a.prototype.onMediaClickHandler=function(b){var c;b=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;R["default"].setLocation(this.createRedirectUrlToMobileFeed(b.asin,b.physicalid,b.extension,b.reviewid))};a.prototype.createRedirectUrlToMobileFeed=function(b,c,d,e){return"https://"+
da()+"/portal/customer-reviews/mobile-media-feed/"+b+"/ref=cm_cr_dp_ma_crsl_img?ie=UTF8&imageExtension="+d+"&physicalId="+c+"&reviewId="+e};a.prototype.getRefMarker=function(b){return Pb.appendToString(b)};return a}(),Ub=function(){function a(){this.mWebMobileFeedThumbnailClickHandler=new Tb}a.prototype.addMinHeightToParent=function(b){(b=S["default"].cardRoot.ownerDocument.querySelector("."+b))&&b.parentElement&&(b.parentElement.style.minHeight="inherit")};a.prototype.onVideoClickHandler=function(b){return f.__awaiter(this,
void 0,void 0,function(){return f.__generator(this,function(c){switch(c.label){case 0:return[4,this.mWebMobileFeedThumbnailClickHandler.onVideoClickHandler(b)];case 1:return c.sent(),[2]}})})};a.prototype.onImageClickHandler=function(b){var c;return f.__awaiter(this,void 0,void 0,function(){var d,e,g,l,q,n,v,m,x,h;return f.__generator(this,function(p){switch(p.label){case 0:return d=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset,e=ja["default"].setup(["triggerWeblab"]),g=d.photopopovermwebgatingtreatment||
"C",l="C",q=d.iskindleapp?"true"===d.iskindleapp.toLowerCase():!1,(n="T1"===g&&!q)?[4,e.triggerWeblab({weblabId:"CM_CR_MEDIA_CAROUSEL_PHOTO_POPOVER_MWEB_678973"}).then(function(k){l=k.treatment})]:[3,2];case 1:p.sent(),p.label=2;case 2:if(!n||"T1"!==l)return[3,5];v=pa["default"].cardRoot.getElementsByClassName("_Y3Itb_media-popover-container_2BBbs")[0];m="cr-media-popover";return[4,rb.get(m,v,b.currentTarget)];case 3:return x=p.sent(),h=A[d.mediatype],[4,ma.loadMediaPopover({mediaType:h,asin:d.asin,
reviewId:d.reviewid,mediaId:d.physicalid,popoverDetails:{popoverName:m,popover:x}})];case 4:return p.sent(),this.addMinHeightToParent("_Y3Itb_media-popover-container_2BBbs"),b.currentTarget&&b.currentTarget.classList.remove("a-declarative"),[3,6];case 5:this.mWebMobileFeedThumbnailClickHandler.onImageClickHandler(b),p.label=6;case 6:return[2]}})})};a.prototype.onSeeMoreClickHandler=function(b){var c;return f.__awaiter(this,void 0,void 0,function(){var d,e,g,l;return f.__generator(this,function(q){d=
null===(c=b.currentTarget)||void 0===c?void 0:c.dataset;e=A[d.mediatype];g=ta(e);l=d.asin;if(g===U.IMAGE)R["default"].setLocation(Ka(Ob.toString(),U.IMAGE,l));else throw K.logError("loadVideoGalleryError",g),Error("Video gallery is not available on mWeb.");return[2]})})};return a}(),Vb=function(){function a(){}a.getThumbnailClickHandler=function(){return f.__awaiter(this,void 0,void 0,function(){var b;return f.__generator(this,function(c){switch(c.label){case 0:return[4,Na()];case 1:b=c.sent();switch(b){case T.MSHOP:return[2,
new Qb];case T.MWEB:return[2,new Ub];case T.DESKTOP:return[2,new Jb]}return[2]}})})};return a}(),Wb=function(){function a(b){this.clickHandler=this.clickHandler=b}a.prototype.registerThumbnailClickHandlers=function(){this.registerCRVideoThumbnailClickHandler();this.registerCRImageThumbnailClickHandler();this.registerCRSeeMoreThumbnailClickHandler()};a.prototype.registerCRVideoThumbnailClickHandler=function(){var b=this,c=H["default"].setup().define;c(pb.clickHandler,"click",function(d){return f.__awaiter(b,
void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onVideoClickHandler(d)];case 1:return e.sent(),K.logCounter("videoThumbnail.click",1),[2]}})})})};a.prototype.registerCRImageThumbnailClickHandler=function(){var b=this,c=H["default"].setup().define;c(nb.clickHandler,"click",function(d){return f.__awaiter(b,void 0,void 0,function(){return f.__generator(this,function(e){switch(e.label){case 0:return[4,this.clickHandler.onImageClickHandler(d)];
case 1:return e.sent(),K.logCounter("imageThumbnail.click",1),[2]}})})})};a.prototype.registerCRSeeMoreThumbnailClickHandler=function(){var b=this,c=H["default"].setup().define;c(ob.clickHandler,"click",function(d){return f.__awaiter(b,void 0,void 0,function(){var e,g;return f.__generator(this,function(l){switch(l.label){case 0:return[4,this.clickHandler.onSeeMoreClickHandler(d)];case 1:return l.sent(),e=A[null===(g=d.currentTarget)||void 0===g?void 0:g.dataset.mediatype],K.logCounter("seeMore."+
e.toLowerCase()+".click",1),[2]}})})})};return a}(),Ha;(Ha||(Ha={})).closePopoverClickHandler="ClosePopoverClickHandler";var Xb=function(){function a(){}a.registerClosePopoverClickHandler=function(){var b=H["default"].setup().define;b(Ha.closePopoverClickHandler,"click",function(c){c.stopBubble();ma.back()})};return a}(),na;(function(a){a.expandTextClickHandler="expandTextClickHandler";a.hideTextClickHandler="hideTextClickHandler";a.toggleTextClickHandler="toggleTextClickHandler"})(na||(na={}));var Yb=
function(){function a(){}a.registerTextExpanderClickHandlers=function(){a.registerExpandTextClickHandler();a.registerHideTextClickHandler();a.registerToggleTextClickHandler()};a.registerExpandTextClickHandler=function(){var b=H["default"].setup().define;b(na.expandTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.expandText()})};a.registerHideTextClickHandler=function(){var b=H["default"].setup().define;b(na.hideTextClickHandler,"click",
function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.hideText()})};a.registerToggleTextClickHandler=function(){var b=H["default"].setup().define;b(na.toggleTextClickHandler,"click",function(c){c.stopBubble();c=a.getTextExpanderClient(c);null===c||void 0===c?void 0:c.toggleText()})};a.getTextExpanderClient=function(b){var c;b=null===(c=b.currentTarget)||void 0===c?void 0:c.dataset.reviewid;return Ga(J.getPopoverWidgetById(b))};return a}(),Xa=function(){function a(){this.errorDialog=
S["default"].cardRoot.ownerDocument.querySelector("._Y3Itb_media-popover-error-dialog_2LoQP")}a.prototype.show=function(){D(this.errorDialog)};a.prototype.hide=function(){B(this.errorDialog)};return a}(),Ia;(Ia||(Ia={})).closeToastBar="closeToastBarClickHandler";var Ya=function(){function a(){}a.registerCloseToastBarClickHandler=function(){var b=H["default"].setup().define;b(Ia.closeToastBar,"click",function(c){c.stopBubble();c=c.currentTarget.closest("div[data-toast-bar-name='"+c.currentTarget.dataset.toastBarName+
"']");u(c,function(d){return B(d)})})};return a}(),Zb=function(){function a(){}a.prototype.registerMediaPopoverClickHandlers=function(){Xb.registerClosePopoverClickHandler();this.registerOpenPopoverReportConfirmationDialog();this.registerHelpfulVoteClickHandler();this.registerMediaOverlayClickHandlers();this.registerNoopHandler();this.registerConfirmReportAbuseClickHandler();this.registerClosePopoverErrorDialogClickHandler();this.registerLoadMediaPopoverClickHandler();Ya.registerCloseToastBarClickHandler()};
a.prototype.registerNoopHandler=function(){var b=H["default"].setup().define;b(Q.noopHandler,"click",function(c){c.stopBubble()})};a.prototype.registerMediaOverlayClickHandlers=function(){this.registerMediaOverlayNavigationClickHandlers();Yb.registerTextExpanderClickHandlers()};a.prototype.registerClosePopoverErrorDialogClickHandler=function(){var b=H["default"].setup().define;b(Q.closePopoverErrorDialogClickHandler,"click",function(c){c.stopBubble();(new Xa).hide()})};a.prototype.registerMediaOverlayNavigationClickHandlers=
function(){var b=H["default"].setup().define;b(Q.popoverClickHandler,"click",function(c){var d=c.event,e=c.currentTarget;var g=d.clientX/e.clientWidth*100;d=d.clientY/e.clientHeight*100;e=(e.clientWidth>e.clientHeight?ka.LANDSCAPE:ka.POTRAIT)===ka.POTRAIT?{lowerBound:33,upperBound:67}:{lowerBound:40,upperBound:80};g=d<=e.lowerBound||d>=e.upperBound?L.NONE:25>=g?L.LEFT:75<=g?L.RIGHT:L.CENTER;(new J(J.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(g)});b(Q.desktopRightClickHandler,
"click",function(c){(new J(J.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(L.RIGHT)});b(Q.desktopLeftClickHandler,"click",function(c){(new J(J.getPopoverWidgetById(c.currentTarget.dataset.reviewid))).handlePopoverClick(L.LEFT)})};a.prototype.registerOpenPopoverReportConfirmationDialog=function(){var b=H["default"].setup().define;b(Q.openReportConfirmationDialogClickHandler,"click",function(c){c.stopBubble();ma.showReportAbuseConfirmationDialog(c.currentTarget.dataset.id,
c.currentTarget.dataset.asin)})};a.prototype.showErrorDialog=function(){(new sa).hide();(new Xa).show()};a.prototype.registerConfirmReportAbuseClickHandler=function(){var b=this,c=H["default"].setup().define,d=ja["default"].setup(["reportAbuse"]);c(Q.confirmReportAbuseClickHandler,"click",function(e){e.stopBubble();var g=e.currentTarget.firstChild.dataset.id;e=e.currentTarget.firstChild.dataset.asin;d.reportAbuse({reviewId:g,domain:da(),asin:e}).then(function(l){!l.success&&l.redirectUrl?R["default"].setLocation(l.redirectUrl):
l.success?(ma.back(),(new J(J.getPopoverWidgetById(g))).scrollIntoNextPopover(),(new ba("reportAbuseThankYouMessage")).show()):b.showErrorDialog()})})};a.prototype.registerHelpfulVoteClickHandler=function(){var b=this,c=H["default"].setup().define,d=ja["default"].setup(["helpful"]);c(Q.helpfulVoteClickHandler,"click",function(e){e.stopBubble();var g=e.currentTarget.dataset.id;e=e.currentTarget.dataset.asin;d.helpful({reviewId:g,domain:da(),asin:e}).then(function(l){!l.success&&l.redirectUrl?R["default"].setLocation(l.redirectUrl):
l.success?(new Fa(Fa.getActionButtonsContainer(g))).likeButtonClicked():b.showErrorDialog()})})};a.prototype.registerLoadMediaPopoverClickHandler=function(){var b=this,c=H["default"].setup().define;c(Q.loadMediaPopover,"click",function(d){return f.__awaiter(b,void 0,void 0,function(){var e,g,l,q;return f.__generator(this,function(n){switch(n.label){case 0:return e=new Wa,g=null===(q=d.currentTarget)||void 0===q?void 0:q.dataset,l=A[g.mediatype],e.show(),e.setLoadingAnimation(!0),[4,ma.loadMediaPopover({asin:g.asin,
mediaType:l,reviewId:g.reviewid,mediaId:g.mediaid,popoverDetails:{popoverName:g.popovername},isDesktop:!Ma()})];case 1:return n.sent(),[2]}})})})};return a}(),N=H["default"].setup().define,O=function(a,b){u(a.currentTarget,function(c){var d=Qa(c);if(!d.mediaType)throw Error("unable to extract mediaType from element: "+a.operationName+", "+c.nodeName);var e=la.getData(d.mediaType);if(!e)throw Error("unable to get modalManager: "+a.operationName+", "+d);b(e,d,c.dataset)})},$b=function(){N(I.galleryItemClickHandler,
"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c,d,e){if(!d.reviewId||!d.mediaId)throw Error("reviewId or mediaId was not found on the media gallery item: "+JSON.stringify(e));c.updateModalWithReview(d.reviewId,d.mediaId,d.mediaType)});return[2]})})})},ac=function(){N(I.showMediaGalleryClickHandler,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return c.showMediaGallery()});
return[2]})})})},bc=function(){N(I.reloadMediaPopover,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c,d,e){if("true"===e.showgalleryinmodal&&!d.asin)throw Error("asin was not found on the toastbar : "+JSON.stringify(e));if(!("true"===e.showgalleryinmodal||d.reviewId&&d.mediaId&&d.asin))throw Error("reviewId/mediaId/asin was not found on the toastbar : "+JSON.stringify(e));c.loadModal({asin:d.asin,mediaId:d.mediaId,reviewId:d.reviewId,
mediaType:d.mediaType,showGalleryInModal:"true"==e.showgalleryinmodal?!0:!1,popoverDetails:{popoverName:e.popovername}})});return[2]})})})},cc=function(){N(I.thumbnailClickHandler,"click",function(a){O(a,function(b,c,d){if(!c.mediaId)throw Error("mediaId was not found while clicking on media thumbnail: "+d);b.updateMediaInModal(c.mediaId)})})},dc=function(){N(I.rightClickHandler,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return c.handleModalMediaProgressionClick(L.RIGHT)});
return[2]})})});N(I.leftClickHandler,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return c.handleModalMediaProgressionClick(L.LEFT)});return[2]})})})},ec=function(){N(I.expandTextClickHandler,"click",function(a){O(a,function(b){return b.handleExpanderClick(ea.EXPAND)})});N(I.hideTextClickHandler,"click",function(a){O(a,function(b){return b.handleExpanderClick(ea.HIDE)})})},fc=function(){N(I.openReportConfirmationDialogClickHandler,
"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(d){c.openReportAbuseDialog(a.currentTarget);return[2]})})});return[2]})})});N(I.confirmReportAbuseClickHandler,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,
function(d){c.handleReportAbuseClick();return[2]})})});return[2]})})})},gc=function(){N(I.helpfulVoteClickHandler,"click",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(d){c.handleHelpulVoteClick();return[2]})})});return[2]})})})},hc=function(){N(I.noopHandler,"click",function(a){a.stopBubble()})},ic=function(){N(I.mouseMovementHandler,"mouseenter",
function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(d){c.toggleMediaButtonsVisibility(!0);return[2]})})});return[2]})})});N(I.mouseMovementHandler,"mouseleave",function(a){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,function(b){O(a,function(c){return f.__awaiter(void 0,void 0,void 0,function(){return f.__generator(this,
function(d){c.toggleMediaButtonsVisibility(!1);return[2]})})});return[2]})})})},jc=function(){return f.__awaiter(void 0,void 0,void 0,function(){var a,b;return f.__generator(this,function(c){switch(c.label){case 0:return[4,Na()];case 1:a=c.sent();switch(a){case T.DESKTOP:$b();ac();bc();cc();dc();ec();fc();gc();hc();Ya.registerCloseToastBarClickHandler();ic();break;case T.MWEB:b=new Zb,b.registerMediaPopoverClickHandlers()}return[2]}})})};Ja._operationNames=[];Ja.card=function(){return f.__awaiter(void 0,
void 0,void 0,function(){var a,b;return f.__generator(this,function(c){switch(c.label){case 0:return K.setPrefix("cr-media-carousel"),[4,Vb.getThumbnailClickHandler()];case 1:return a=c.sent(),b=new Wb(a),b.registerThumbnailClickHandlers(),[4,xa()];case 2:return c.sent()?[3,4]:[4,jc()];case 3:c.sent(),c.label=4;case 4:return K.logCounter("client.loaded",1),[2]}})})}});
