(function(f){var h=window.AmazonUIPageJS||window.P,r=h._namespace||h.attributeErrors,c=r?r("BuyItOnABUIAssets",""):h;c.guardFatal?c.guardFatal(f)(c,window):c.execute(function(){f(c,window)})})(function(f,h,r){f.declare("abRegistrationConstants",{AB_REGISTRATION_IFRAME:"ab-registration-iframe",AB_REGISTRATION_BOTTOM_SHEET:"ab_registration_bottom_sheet",AB_REGISTRATION_DECLARATIVE_ACTION:"start-ab-registration",AB_REGISTRATION_MOBILE_CONTAINER:"ab-registration-mobile-container",AB_PARTNERSHIP_GATEWAY_BUSINESS_LICENSE_TYPE:"GST",
AB_PARTNERSHIP_GATEWAY_INDUSTRY:"Other",AB_PARTNERSHIP_GATEWAY_URL:"/abpartner/createInvitations?partnerId\x3dRetailCustomer_IN",ADDRESS_VALIDATION_URL:"/business/register/org/lookup-address",GST_IN_SAVINGS_QUERY_PARAM:"gstInAsinSavings",CLIENT_ID_IFRAME_QUERY_PARAM:"client",CLIENT_ID_VALUE_IFRAME_QUERY_PARAM:"embed",REF_TAG_QUERY_PARAM:"ref_",REF_TAG_VALUE_QUERY_PARAM:"ab_reg_retailcustomer_in",REGISTRATION_STATUS_QUERY_STRING:"registrationStatus",CUSTOMER_PENDING_VERIFICATION:"PENDING",VALIDATE_GST_URL:"/cv/validate-gst",
IN_MARKETPLACE_CODE:"IN",BOTTOM_SHEET_DURATION:.3,NORMAL_BOTTOM_SHEET_HEIGHT:.7,ABRW_CONTAINER_ID:"ABRegistrationWebsite",DETAIL_PAGE_TYPE:"DETAIL",PENDING_VERIFICATION_URL:"/business/register/pending-verification?client\x3dembed"});"use strict";f.when("A","ready").register("abRegistrationPageState",function(c){var a=c.state("abRegistrationPageState");return{refreshPageState:function(){a=c.state("abRegistrationPageState")},getPageState:function(){return a}}});"use strict";f.when("A","ready").register("abRegistrationEnums",
function(c){return{ACTION_TYPE:Object.freeze({CLOSE:"CLOSE",REDIRECT:"REDIRECT",RESIZE:"RESIZE"}),TEXT_INPUT_TYPE:Object.freeze({WARNING:"warning",ERROR:"error"}),ALERT_ERROR_TYPE:Object.freeze({WARNING:"warning",ERROR:"error"}),TEXT_INPUT_STATUS:Object.freeze({ENABLED:"enabled",DISABLED:"disabled"}),GST_STATUS:Object.freeze({VALID:"VALID",INVALID:"INVALID",PENDING:"PENDING",INACTIVE:"INACTIVE"}),GST_VALIDATE_ERROR_CODE:Object.freeze({EVS_TIMEOUT_ERROR:"EVS_TIMEOUT_ERROR",EVS_EMPTY_RESPONSE:"EVS_EMPTY_RESPONSE"})}});
"use strict";f.when("A","abRegistrationPageState","ready").register("abRegistrationMetricsHelper",function(c,a){return{emitNexusEvent:function(c,b){h.ue&&h.ue.event?(c={pageType:c,subPageType:b,deviceType:a.getPageState().deviceType,marketplaceId:a.getPageState().marketplaceId},h.ue.event(c,"inb2b_abregistration","inb2b.abregistration.funnel.2")):h.ueLogError("No Nexus metric emitter found!")},emitClickStreamCounterEvent:function(a){h.ue&&h.ue.count?h.ue.count("dpx.b2b.buyItOnAb."+a,1):h.ueLogError("No ClickStream metric emitter found!")}}});
"use strict";f.when("A","a-button","a-alert","abRegistrationEnums","ready").register("abRegistrationAlertUtils",function(c,a,h,b){function f(a,b,d){h("#tax-id-error-alert").type(b).html(a).show();g("#tax-id-text-input").parent().addClass("a-form-"+d)}function e(a){h("#tax-id-error-alert").text("").hide();g("#tax-id-text-input").parent().removeClass("a-form-"+a)}function d(){g("#spinner-overlay").addClass("aok-hidden").removeClass("aok-block")}function m(a){g("#tax-id-text-input").attr(a,a)}var g=
c.$;return{showErrorMessage:function(g){f(g,b.ALERT_ERROR_TYPE.ERROR,b.TEXT_INPUT_TYPE.ERROR);a("#tax-id-submit-button").enable();m(b.TEXT_INPUT_STATUS.ENABLED);d()},hideSpinner:function(){d()},validateTaxIdInput:function(a,b){return(new RegExp(b)).test(a)},handleTaxIdRegexSuccess:function(){g("#spinner-overlay").addClass("aok-block").removeClass("aok-hidden");a("#tax-id-submit-button").disable();e(b.ALERT_ERROR_TYPE.ERROR);e(b.ALERT_ERROR_TYPE.WARNING)},enableSubmitButton:function(){a("#tax-id-submit-button").enable()},
getTaxIdTextInputValue:function(){return g("#tax-id-text-input").val().trim()},showWarningMessage:function(g){f(g,b.ALERT_ERROR_TYPE.WARNING,b.TEXT_INPUT_TYPE.WARNING);a("#tax-id-submit-button").enable();m(b.TEXT_INPUT_STATUS.ENABLED);d()}}});"use strict";f.when("A","abRegistrationConstants","abRegistrationAlertUtils","a-sheet","ready").register("abRegistrationBottomSheetUtils",function(c,a,f,b){function t(g,c,l,u){d("\x3ciframe\x3e",{src:g,id:c,sandbox:"allow-forms allow-scripts allow-same-origin allow-top-navigation",
class:"a-spacing-top-micro"}).appendTo("#"+l);var n=document.getElementById(a.AB_REGISTRATION_IFRAME);n.addEventListener("load",function(){e(n,function(){f.hideSpinner();n.style.display="block";b.showSheet(u);n.contentWindow.document&&n.contentWindow.document.body&&(m=new h.ResizeObserver(function(){n.contentWindow.document.body&&u.changeHeight({height:n.contentWindow.document.body.scrollHeight,duration:0})}),m.observe(n.contentWindow.document.body))})})}function e(a,b){function d(){k||(k=!0,clearTimeout(m),
b.call(this))}function g(){"complete"===this.readyState&&d.call(this)}function e(a,k,b){if(a.addEventListener)return a.addEventListener(k,b);if(a.attachEvent)return a.attachEvent("on"+k,function(){return b.call(a,h.event)});a["on"+k]=function(){return b.call(a,h.event)}}function f(){var k=a.contentDocument||a.contentWindow.document;0!==k.URL.indexOf("about:")?"complete"===k.readyState?d.call(k):(e(k,"DOMContentLoaded",d),e(k,"readystatechange",g)):m=c.delay(f,1)}var m,k=!1;e(a,"load",function(){d.call(a.contentDocument||
a.contentWindow.document)});f()}var d=c.$,m;return{renderIframeWithinBottomSheet:function(e,c,l){l={name:a.AB_REGISTRATION_BOTTOM_SHEET,inlineContent:"",preloadDomId:c,closeType:"icon",height:h.innerHeight*l};var g;(g=b.get(l.name))||(g=b.create(l));d(c).empty();g.changeHeight({height:l.height,duration:a.BOTTOM_SHEET_DURATION});l=a.AB_REGISTRATION_IFRAME;null===document.getElementById(l)?t(e,l,c,g):b.showSheet(g)},hideNamedSheet:function(a){(a=b.get(a))&&b.hideSheet(a)},destroySheetInstanceIfExists:function(a){(a=
b.get(a))&&a.destroy()},getResizeObserver:function(){return m}}});"use strict";f.when("A","abRegistrationConstants","abRegistrationEnums","abRegistrationAlertUtils","abRegistrationBottomSheetUtils","abRegistrationMetricsHelper","abRegistrationPageState","ready").register("abRegistrationAjax",function(c,a,f,b,q,e,d){function m(a,b,d,c){return r.ajax({type:a,url:b,headers:d,data:c,contentType:"application/json; charset\x3dutf-8",dataType:"json"})}function g(){return m("GET",a.VALIDATE_GST_URL,{"ACCEPT-LANGUAGE":d.getPageState().localeId},
{GSTIN:b.getTaxIdTextInputValue()}).fail(function(a){if(401===a.status)e.emitClickStreamCounterEvent("gstValidationAjaxCall.unauthorized");else{var k=a.getResponseHeader("Content-Type"),c=a.responseText,l=400===a.status,g="string"===typeof c;k=k&&k.includes("application/json");c=c&&c.includes("errorCode");l&&k&&g&&c?(a=JSON.parse(a.responseText).errorCode,a===f.GST_VALIDATE_ERROR_CODE.EVS_TIMEOUT_ERROR?(e.emitClickStreamCounterEvent("gstValidationAjaxCall.errorCodeTimeout"),b.showWarningMessage(d.getPageState().apiTimeOutText)):
a===f.GST_VALIDATE_ERROR_CODE.EVS_EMPTY_RESPONSE?(e.emitClickStreamCounterEvent("gstValidationAjaxCall.errorCodeEmptyMandatoryField"),b.showWarningMessage(d.getPageState().emptyMandatoryFieldFailureText)):(e.emitClickStreamCounterEvent("gstValidationAjaxCall.errorCodeGenericError"),b.showWarningMessage(d.getPageState().genericFailureText))):(e.emitClickStreamCounterEvent("gstValidationAjaxCall.genericError"),b.showWarningMessage(d.getPageState().genericFailureText))}})}function p(k){return m("GET",
a.ADDRESS_VALIDATION_URL,{"ACCEPT-LANGUAGE":d.getPageState().localeId},{zipCode:k.address.pinCode,country:a.IN_MARKETPLACE_CODE}).fail(function(a){401===a.status?e.emitClickStreamCounterEvent("addressValidationAjaxCall.unauthorized"):(e.emitClickStreamCounterEvent("addressValidationAjaxCall.genericError"),b.showWarningMessage(d.getPageState().genericFailureText))})}function l(k,c){return m("POST",a.AB_PARTNERSHIP_GATEWAY_URL,{shoppingPortal:!0},u(k,c)).fail(function(a){401===a.status?e.emitClickStreamCounterEvent("abPartnershipAjaxCall.unauthorized"):
(e.emitClickStreamCounterEvent("abPartnershipAjaxCall.genericError"),b.showWarningMessage(d.getPageState().genericFailureText))})}function u(b,c){var k=h.origin+"/dp/"+d.getPageState().asin;return JSON.stringify({industry:a.AB_PARTNERSHIP_GATEWAY_INDUSTRY,businessLicenseType:a.AB_PARTNERSHIP_GATEWAY_BUSINESS_LICENSE_TYPE,businessLicenseValue:b.GSTIN,businessName:b.businessName,contactName:b.contactName,addressLine1:b.address.addressLine1,addressLine2:b.address.addressLine2,postalCode:b.address.pinCode,
city:null===c?b.address.city:c.city,state:b.address.state,countryCode:a.IN_MARKETPLACE_CODE,registrationEgressUrl:k})}function n(){g().done(function(a){if(a.status!==f.GST_STATUS.VALID)switch(a.status){case f.GST_STATUS.INVALID:e.emitClickStreamCounterEvent("gstValidationStatus.invalid");b.showErrorMessage(d.getPageState().invalidGSTText);break;case f.GST_STATUS.PENDING:e.emitClickStreamCounterEvent("gstValidationStatus.pending");b.showWarningMessage(d.getPageState().pendingGSTText);break;case f.GST_STATUS.INACTIVE:e.emitClickStreamCounterEvent("gstValidationStatus.inactive");
b.showErrorMessage(d.getPageState().inactiveGSTText);break;default:e.emitClickStreamCounterEvent("gstValidationStatus.unknown"),b.showWarningMessage(d.getPageState().genericFailureText)}else e.emitClickStreamCounterEvent("gstValidationAjaxCall.success"),d.getPageState().abrwCallTreatment?l(a,null).done(function(a){e.emitClickStreamCounterEvent("abPartnershipAjaxCall.success");t(a)}):p(a).done(function(b){e.emitClickStreamCounterEvent("addressValidationAjaxCall.success");l(a,b).done(function(a){e.emitClickStreamCounterEvent("abPartnershipAjaxCall.success");
t(a)})})})}function t(c){c=new URL(c.invitationURL);var l=(new Intl.NumberFormat(d.getPageState().localeId,{style:"currency",currency:d.getPageState().totalSavingsCurrency})).format(d.getPageState().totalSavingsAmount);c.searchParams.set(a.GST_IN_SAVINGS_QUERY_PARAM,l);c.searchParams.set(a.CLIENT_ID_IFRAME_QUERY_PARAM,a.CLIENT_ID_VALUE_IFRAME_QUERY_PARAM);c.searchParams.set(a.REF_TAG_QUERY_PARAM,a.REF_TAG_VALUE_QUERY_PARAM);b.enableSubmitButton();e.emitNexusEvent(a.DETAIL_PAGE_TYPE,"showRegistrationBottomSheet");
e.emitClickStreamCounterEvent("bottomSheet.shown");q.renderIframeWithinBottomSheet(c,a.AB_REGISTRATION_MOBILE_CONTAINER,a.NORMAL_BOTTOM_SHEET_HEIGHT)}var r=c.$;return{startABRegistrationAjaxCalls:function(){n()},isPostMessageValid:function(b){var c=b.data.containerId===a.ABRW_CONTAINER_ID;b=(new URL(b.origin)).host===h.location.host;return c&&b}}});"use strict";f.when("A","abRegistrationConstants","abRegistrationEnums","abRegistrationAlertUtils","abRegistrationBottomSheetUtils","abRegistrationAjax",
"abRegistrationMetricsHelper","abRegistrationPageState","ready").execute(function(c,a,f,b,q,e,d,m){function g(){var b=q.getResizeObserver();b&&(b.disconnect(),p("#"+a.AB_REGISTRATION_IFRAME).remove(),d.emitClickStreamCounterEvent("bottomSheet.closed"),d.emitNexusEvent(a.DETAIL_PAGE_TYPE,"closedBottomSheet"))}var p=c.$;(new URL(document.location)).searchParams.get(a.REGISTRATION_STATUS_QUERY_STRING)===a.CUSTOMER_PENDING_VERIFICATION&&(d.emitNexusEvent(a.DETAIL_PAGE_TYPE,"showPendingBottomSheet"),d.emitClickStreamCounterEvent("bottomSheet.pendingVerification.shown"),
q.renderIframeWithinBottomSheet(a.PENDING_VERIFICATION_URL,a.AB_REGISTRATION_MOBILE_CONTAINER,a.NORMAL_BOTTOM_SHEET_HEIGHT));c.declarative(a.AB_REGISTRATION_DECLARATIVE_ACTION,"click",function(c){c.$event.preventDefault();d.emitClickStreamCounterEvent("taxId.submitted");d.emitNexusEvent(a.DETAIL_PAGE_TYPE,"submitTaxId");b.validateTaxIdInput(b.getTaxIdTextInputValue(),"^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$")?(b.handleTaxIdRegexSuccess(),d.emitClickStreamCounterEvent("taxId.regexPassed"),
e.startABRegistrationAjaxCalls()):(d.emitClickStreamCounterEvent("taxId.regexFailed"),b.showErrorMessage(m.getPageState().taxIdRegexFailureText))});c.on("a:pageUpdate",function(b){m.refreshPageState();p("#"+a.AB_REGISTRATION_IFRAME).remove();b=p("#ab-registration-mobile-container").clone();p("#ab-registration-mobile-container").remove();p("#ab-registration-mobile-anchor").append(b);q.destroySheetInstanceIfExists(a.AB_REGISTRATION_BOTTOM_SHEET);c.on("a:sheet:afterHide:"+a.AB_REGISTRATION_BOTTOM_SHEET,
function(a){g()})});c.on("a:sheet:afterHide:"+a.AB_REGISTRATION_BOTTOM_SHEET,function(a){g()});h.addEventListener("message",function(b){if(e.isPostMessageValid(b))switch(b.data.action){case f.ACTION_TYPE.CLOSE:q.hideNamedSheet(a.AB_REGISTRATION_BOTTOM_SHEET);break;case f.ACTION_TYPE.REDIRECT:(new URL(b.data.destinationUrl)).host===h.location.host&&(h.location.href=b.data.destinationUrl,d.emitClickStreamCounterEvent("bottomSheet.redirect"))}})})});
/* ******** */
(function(c){var b=window.AmazonUIPageJS||window.P,d=b._namespace||b.attributeErrors,a=d?d("DetailPageRewardsCardAssets","DetailPageRewardsCard"):b;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,b,d){});
/* ******** */
